Noob is an easy box by VIEH Group.  The protocols used are fairly wide open; the main challenge is in figuring out some steganography.

After installing the box, first I had to find its IP address.

The command 
```
$ nmap 192.168.121.0/24
```

is usind CIDR notation to look for all 255 boxes on the 192.168.121.0 subnet.

Mine instance of Noob recieved an address through DHCP of 192.68.121.138.

Now for a more through nmap scan piping the output to a file called nmap:

```
$ nmap 192.168.121.138 -A -T4 -p- > nmap
```

-A
	enables OS detection, version detection, script scanning, and traceroute
	
-T4
	sets the timing faster.  Nmap.org describes level 4 as Aggressive; this may be more easily detected by an IDS, but I don't suspect one being in play here
	
-p- 
	scans all ports
	
Our results show three ports open
PORT      STATE SERVICE VERSION
21/tcp    open  ftp     vsftpd 3.0.3
| ftp-anon: Anonymous FTP login allowed (FTP code 230)
80/tcp    open  http    Apache httpd 2.4.29 ((Ubuntu))
55077/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0)

neglecting to scan for all ports would have missed that emphemeral ssh port.

Going down the list, we see that ftp allows anonymous logins; username 'anonymous' with a blank password.

```
$ ftp 192.168.121.138                                                   

Connected to 192.168.121.138.
220 (vsFTPd 3.0.3)
Name (192.168.121.138:kali): anonymous
331 Please specify the password.
Password:
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp> ls
200 PORT command successful. Consider using PASV.
150 Here comes the directory listing.
-rw-r--r--    1 0        0              21 Sep 21 18:50 cred.txt
-rw-r--r--    1 0        0              86 Jun 11 21:53 welcome
226 Directory send OK.
ftp> get cred.txt
local: cred.txt remote: cred.txt
200 PORT command successful. Consider using PASV.
150 Opening BINARY mode data connection for cred.txt (21 bytes).
226 Transfer complete.
21 bytes received in 0.00 secs (4.5241 kB/s)
ftp> get welcome
local: welcome remote: welcome
200 PORT command successful. Consider using PASV.
150 Opening BINARY mode data connection for welcome (86 bytes).
226 Transfer complete.
86 bytes received in 0.00 secs (19.6685 kB/s)
ftp> exit
221 Goodbye.
```

Right away we find some creds, and when we cat out the file, we get: 

```
Y2hhbXA6cGFzc3dvcmQ=
```

This looks like it's base64 encoded.  We can decode it with:

```
$ cat cred.txt | base64 -d
champ:password
```

The other file is a welcome message that doesn't look terribly interesting.

Moving on to the website, navigating to the uri we see a login page.

![[Pasted image 20211110134144.png]]

We try the creds we found and login.  I aslso tried them with the ssh port, but they didn't work.

![[Pasted image 20211110134518.png]]

I tried looking at 192.168.121.138/robots.txt but got a 404.  I looked at the source code for the login page and the home page, but didn't see anything interesting.  There was a foreign phrase in the metadata of the home page: "Dobro dosli u najbolji kafic na svetu".  Google translate identifeid this a Bosnian and translated it to "Welcome to the best cafe in the world"  I put that phrase in the back of my head, but it didn't end up coming into play.   It's worth noting the home index page is a .php file, although this didn't end up coming into play either.  On the home page, there's an about us link which provides a download of a .rar file.  

Unpacking this 

```
$ unrar e downloads.rar 
```

reveals two image files and a file called sudo.

The image files appeared identical to the eye, they just had different extensions.  Opening them showed a message of encouragement, but nothing else popped out.

![[Pasted image 20211110140804.png]]

Sudo has a puzzling message: 

```
Did you notice the file name?  Isn't it interesting?
```

I imagine this will be a permission escalation method later on when we get a foothold on the system.

With nothing else to go on, I guessed that the images were using stegonography to hide information.

I tried comparing them with diff, found a script online that pulled out the least significant bit from each pixel color, as this is a common method of steganograpy, but got now where.  Steghide requires a passphrase to extract informaiton, but I wanted to see if there was a tool that could use a wordlist.  

I found [stegcracker](https://www.kali.org/tools/stegcracker/), but when I ran it, I got the message 

```
StegCracker has been retired following the release of StegSeek, which 
will blast through the rockyou.txt wordlist within 1.9 second as opposed 
to StegCracker which takes ~5 hours.
```

So I installed [stegseek](https://github.com/RickdeJager/stegseek) instead and tried it out with the rockyou wordlist.  It was amazingly swift!

I couldn't find a passphrase for funny.bmp, but funny.jpg opened with an empty passphrase.  the original filename was hint.py, but opening it was just a phrase: 

```
This is_not a python file but you are revolving around.
well, try_ to rotate some words too.
```

I'm guessing a rotation cipher will come into play at some point.  

I was sure the bmp file also had a hidden message in it.  I tried the bosnian words and phrase, but no luck.  I was also sure the clue would be given somewhere. 

On a whim, I tried "sudo" as the password and it worked:
```
$ steghide extract -p 'sudo' -sf funny.bmp                             wrote extracted data to "user.txt".
$cat user.txt                                                           jgs:guvf bar vf n fvzcyr bar
```
This must be our rotated creds.

dcode.fr has a plethora of encryption/decryption tools.  I first tried rot13, the original ceasar cipher: 

![[Pasted image 20211110141846.png]]

wtf:this one is a simple one

This looked like the format of the previous creds, so I tried them with ssh:

```
$ ssh wtf@192.168.121.138 -p 55077                                     wtf@192.168.121.138's password: 
Welcome to Ubuntu 18.04.5 LTS (GNU/Linux 4.15.0-156-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Wed Nov 10 19:20:25 UTC 2021

  System load:  0.0               Processes:            184
  Usage of /:   54.9% of 8.79GB   Users logged in:      0
  Memory usage: 30%               IP address for ens33: 192.168.121.138
  Swap usage:   0%

 * Super-optimized for small spaces - read how we shrank the memory
   footprint of MicroK8s to make it the smallest full K8s around.

   https://ubuntu.com/blog/microk8s-memory-optimisation

75 packages can be updated.
1 update is a security update.


*** System restart required ***
Last login: Tue Sep 21 19:59:59 2021 from 192.168.169.1
 ______________________________________
/ You will have domestic happiness and \
\ faithful friends.                    /
 --------------------------------------
   \
    \
        .--.
       |o_o |
       |:_/ |
      //   \ \
     (|     | )
    /'\_   _/`\
    \___)=(___/

wtf@wtf:~$ 
```

And we're in!

The first thing I try when I log in is sudo -l to see if there's any specific files with elevated permissions.

```
wtf@wtf:~$ sudo -l
[sudo] password for wtf:                                                                                                                                                 
Matching Defaults entries for wtf on wtf:                                                                                                                                
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin                                                    
User wtf may run the following commands on wtf:                                                                                                                          
    (ALL : ALL) ALL                      
```                                    

We can run any command as root!

```
wtf@wtf:~$ sudo -u root /bin/bash                                       Command 'fortune' is available in '/usr/games/fortune'                 Command 'cowsay' is available in '/usr/games/cowsay'                   The command could not be located because '/usr/games' is not included in the PATH environment variable.                                       cowsay: command not found                                               The command could not be located because '/usr/games' is not included in the PATH environment variable.                                       fortune: command not found                                             root@wtf:~# whoami
root
root@wtf:~# cd /root
root@wtf:/root# ls
root.txt  snap
root@wtf:/root# cat root.txt
RW5kb3JzZSBtZSBvbiBsaW5rZWRpbiA9PiBodHRwczovL3d3dy5saW5rZWRpbi5jb20vaW4vZGVlcGFrLWFoZWVyCg==

Follow me on Twitter https://www.twitter.com/Deepakhr9

TryHackMe --> https://www.tryhackme.com/p/Malwre99
Github --> https://www.github.com/Deepak-Aheer
(the flag is my LinkedIn username)


        THANK YOU for PLAYING THIS CTF

        But REMEMBER we're still N00bs ;)
```
Hmm, where to find the LinkedIn username...

Looks like we have one more base64 encoded message.  
```
root@wtf:/root# echo 'RW5kb3JzZSBtZSBvbiBsaW5rZWRpbiA9PiBodHRwczovL3d3dy5saW5rZWRpbi5jb20vaW4vZGVlcGFrLWFoZWVyCg==' | base64 -d
Endorse me on linkedin => https://www.linkedin.com/in/<redacted>
```
and we have solved this box.  

Looking for easter eggs, I tried the commands that came back as errors when I opened up a bash shell as root; [fortune](https://linux.die.net/man/6/fortune) returns a random quote or fortune, but [cowthink](https://linux.die.net/man/1/cowthink) just seemed to hang.

